<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 3.14.6"/><link rel="icon" href="/tietokannat/favicon-32x32.png?v=dd253edc615d56282c5dcdfb24ca4261" type="image/png"/><link rel="manifest" href="/tietokannat/manifest.webmanifest" crossorigin="anonymous"/><meta name="theme-color" content="#a2466c"/><link rel="apple-touch-icon" sizes="48x48" href="/tietokannat/icons/icon-48x48.png?v=dd253edc615d56282c5dcdfb24ca4261"/><link rel="apple-touch-icon" sizes="72x72" href="/tietokannat/icons/icon-72x72.png?v=dd253edc615d56282c5dcdfb24ca4261"/><link rel="apple-touch-icon" sizes="96x96" href="/tietokannat/icons/icon-96x96.png?v=dd253edc615d56282c5dcdfb24ca4261"/><link rel="apple-touch-icon" sizes="144x144" href="/tietokannat/icons/icon-144x144.png?v=dd253edc615d56282c5dcdfb24ca4261"/><link rel="apple-touch-icon" sizes="192x192" href="/tietokannat/icons/icon-192x192.png?v=dd253edc615d56282c5dcdfb24ca4261"/><link rel="apple-touch-icon" sizes="256x256" href="/tietokannat/icons/icon-256x256.png?v=dd253edc615d56282c5dcdfb24ca4261"/><link rel="apple-touch-icon" sizes="384x384" href="/tietokannat/icons/icon-384x384.png?v=dd253edc615d56282c5dcdfb24ca4261"/><link rel="apple-touch-icon" sizes="512x512" href="/tietokannat/icons/icon-512x512.png?v=dd253edc615d56282c5dcdfb24ca4261"/><title data-react-helmet="true">Tehokkuus</title><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){if(void 0===e.target.dataset.mainImage)return;if(void 0===e.target.dataset.gatsbyImageSsr)return;const t=e.target;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><link as="script" rel="preload" href="/tietokannat/webpack-runtime-3a0255c245ffc5167309.js"/><link as="script" rel="preload" href="/tietokannat/framework-d79a9ccabaa25efea902.js"/><link as="script" rel="preload" href="/tietokannat/app-5c8ce36b7ca7ddadeb9f.js"/><link as="script" rel="preload" href="/tietokannat/commons-18bdf9bc0a4174f228aa.js"/><link as="script" rel="preload" href="/tietokannat/component---src-templates-docs-js-7a892bb90a0bfa08d7aa.js"/><link as="fetch" rel="preload" href="/tietokannat/page-data/tehokkuus/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/tietokannat/page-data/sq/d/1885717130.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/tietokannat/page-data/sq/d/1950529541.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/tietokannat/page-data/sq/d/2744905544.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/tietokannat/page-data/sq/d/3020054368.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/tietokannat/page-data/app-data.json" crossorigin="anonymous"/></head><body><script>(function() { try {
  var mode = localStorage.getItem('theme-ui-color-mode');
  if (!mode) return
  document.documentElement.classList.add('theme-ui-' + mode);
} catch (e) {} })();</script><div id="___gatsby"><style data-emotion="css-global xghfnh">html{--theme-ui-colors-header:#fff;--theme-ui-colors-text:#000;--theme-ui-colors-primary:#E10E49;--theme-ui-colors-secondary:#c70d3a;--theme-ui-colors-highlight:#efeffe;--theme-ui-colors-exercise:#3333ee;--theme-ui-colors-sidebar:#f8f5f1;--theme-ui-colors-background:#fff;--theme-ui-colors-borderColor:rgba(0, 0, 0, 0.15);--theme-ui-colors-footer:#E10E49;color:var(--theme-ui-colors-text);background-color:var(--theme-ui-colors-background);}</style><style data-emotion="css-global dcnl1w">*{box-sizing:border-box;}html{font-family:-apple-system,BlinkMacSystemFont,San Francisco,Helvetica Neue,Helvetica,Ubuntu,Roboto,Noto,Segoe UI,Arial,sans-serif;line-height:1.5;font-weight:400;}html h1{font-family:-apple-system,BlinkMacSystemFont,San Francisco,Helvetica Neue,Helvetica,Ubuntu,Roboto,Noto,Segoe UI,Arial,sans-serif;line-height:1.125;font-weight:700;margin-top:0;margin-bottom:16px;font-size:36px;}html h1::before{content:" ";display:block;padding-top:30px;margin-bottom:40px;border-bottom:1px solid;border-bottom-color:var(--theme-ui-colors-borderColor);}html h2{font-family:-apple-system,BlinkMacSystemFont,San Francisco,Helvetica Neue,Helvetica,Ubuntu,Roboto,Noto,Segoe UI,Arial,sans-serif;line-height:1.125;font-weight:700;margin-top:0;margin-bottom:16px;font-size:28px;}html h2::before{content:" ";display:block;padding-top:30px;margin-bottom:40px;border-bottom:1px solid;border-bottom-color:var(--theme-ui-colors-borderColor);}html h3{font-family:-apple-system,BlinkMacSystemFont,San Francisco,Helvetica Neue,Helvetica,Ubuntu,Roboto,Noto,Segoe UI,Arial,sans-serif;line-height:1.125;font-weight:700;margin-top:0;margin-bottom:16px;font-size:24px;}html h3::before{content:" ";display:block;padding-top:30px;margin-bottom:40px;border-bottom:1px solid;border-bottom-color:var(--theme-ui-colors-borderColor);}html h4{font-family:-apple-system,BlinkMacSystemFont,San Francisco,Helvetica Neue,Helvetica,Ubuntu,Roboto,Noto,Segoe UI,Arial,sans-serif;line-height:1.125;font-weight:700;margin-top:0;margin-bottom:16px;font-size:16px;}html h4::before{content:" ";display:block;padding-top:30px;margin-bottom:40px;border-bottom:1px solid;border-bottom-color:var(--theme-ui-colors-borderColor);}html h5{font-family:-apple-system,BlinkMacSystemFont,San Francisco,Helvetica Neue,Helvetica,Ubuntu,Roboto,Noto,Segoe UI,Arial,sans-serif;line-height:1.125;font-weight:700;margin-top:0;margin-bottom:16px;font-size:14px;}html h5::before{content:" ";display:block;padding-top:30px;margin-bottom:40px;border-bottom:1px solid;border-bottom-color:var(--theme-ui-colors-borderColor);}html h6{font-family:-apple-system,BlinkMacSystemFont,San Francisco,Helvetica Neue,Helvetica,Ubuntu,Roboto,Noto,Segoe UI,Arial,sans-serif;line-height:1.125;font-weight:700;margin-top:0;margin-bottom:16px;font-size:12px;}html h6::before{content:" ";display:block;padding-top:30px;margin-bottom:40px;border-bottom:1px solid;border-bottom-color:var(--theme-ui-colors-borderColor);}body{margin:0;}</style><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><style data-emotion="css ylfa0c">.css-ylfa0c{font-family:-apple-system,BlinkMacSystemFont,San Francisco,Helvetica Neue,Helvetica,Ubuntu,Roboto,Noto,Segoe UI,Arial,sans-serif;line-height:1.5;font-weight:400;}.css-ylfa0c h1{font-family:-apple-system,BlinkMacSystemFont,San Francisco,Helvetica Neue,Helvetica,Ubuntu,Roboto,Noto,Segoe UI,Arial,sans-serif;line-height:1.125;font-weight:700;margin-top:0;margin-bottom:16px;font-size:36px;}.css-ylfa0c h1::before{content:" ";display:block;padding-top:30px;margin-bottom:40px;border-bottom:1px solid;border-bottom-color:var(--theme-ui-colors-borderColor);}.css-ylfa0c h2{font-family:-apple-system,BlinkMacSystemFont,San Francisco,Helvetica Neue,Helvetica,Ubuntu,Roboto,Noto,Segoe UI,Arial,sans-serif;line-height:1.125;font-weight:700;margin-top:0;margin-bottom:16px;font-size:28px;}.css-ylfa0c h2::before{content:" ";display:block;padding-top:30px;margin-bottom:40px;border-bottom:1px solid;border-bottom-color:var(--theme-ui-colors-borderColor);}.css-ylfa0c h3{font-family:-apple-system,BlinkMacSystemFont,San Francisco,Helvetica Neue,Helvetica,Ubuntu,Roboto,Noto,Segoe UI,Arial,sans-serif;line-height:1.125;font-weight:700;margin-top:0;margin-bottom:16px;font-size:24px;}.css-ylfa0c h3::before{content:" ";display:block;padding-top:30px;margin-bottom:40px;border-bottom:1px solid;border-bottom-color:var(--theme-ui-colors-borderColor);}.css-ylfa0c h4{font-family:-apple-system,BlinkMacSystemFont,San Francisco,Helvetica Neue,Helvetica,Ubuntu,Roboto,Noto,Segoe UI,Arial,sans-serif;line-height:1.125;font-weight:700;margin-top:0;margin-bottom:16px;font-size:16px;}.css-ylfa0c h4::before{content:" ";display:block;padding-top:30px;margin-bottom:40px;border-bottom:1px solid;border-bottom-color:var(--theme-ui-colors-borderColor);}.css-ylfa0c h5{font-family:-apple-system,BlinkMacSystemFont,San Francisco,Helvetica Neue,Helvetica,Ubuntu,Roboto,Noto,Segoe UI,Arial,sans-serif;line-height:1.125;font-weight:700;margin-top:0;margin-bottom:16px;font-size:14px;}.css-ylfa0c h5::before{content:" ";display:block;padding-top:30px;margin-bottom:40px;border-bottom:1px solid;border-bottom-color:var(--theme-ui-colors-borderColor);}.css-ylfa0c h6{font-family:-apple-system,BlinkMacSystemFont,San Francisco,Helvetica Neue,Helvetica,Ubuntu,Roboto,Noto,Segoe UI,Arial,sans-serif;line-height:1.125;font-weight:700;margin-top:0;margin-bottom:16px;font-size:12px;}.css-ylfa0c h6::before{content:" ";display:block;padding-top:30px;margin-bottom:40px;border-bottom:1px solid;border-bottom-color:var(--theme-ui-colors-borderColor);}</style><div class="css-ylfa0c"><style data-emotion="css-global 5u4lmb">:root{--ease-in-quad:cubic-bezier(0.55, 0.085, 0.68, 0.53);--ease-in-quart:cubic-bezier(0.895, 0.03, 0.685, 0.22);--ease-out-quad:cubic-bezier(0.25, 0.46, 0.45, 0.94);--ease-out-quart:cubic-bezier(0.165, 0.84, 0.44, 1);--ease-in-out-quad:cubic-bezier(0.455, 0.03, 0.515, 0.955);--ease-in-out-quart:cubic-bezier(0.77, 0, 0.175, 1);}*,*:before,*:after{box-sizing:inherit;}:root{box-sizing:border-box;}body{margin:0;}.gatsby-resp-image-image{width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;}</style><style data-emotion="css dl5fst">.css-dl5fst{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:start;-ms-flex-pack:start;-webkit-justify-content:flex-start;justify-content:flex-start;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:1rem 1rem;z-index:5;background:var(--theme-ui-colors-header);-webkit-transition:all 0.25s var(--ease-in-out-quad);transition:all 0.25s var(--ease-in-out-quad);border-bottom:1px solid var(--theme-ui-colors-borderColor);}@media (min-width: 38.73684210526316em){.css-dl5fst{position:fixed;top:0;left:0;right:0;padding:1rem 1.2rem;-webkit-transform:translateX(0);-moz-transform:translateX(0);-ms-transform:translateX(0);transform:translateX(0);}}</style><header class="css-dl5fst eneaom32"><style data-emotion="css 13apmpg">.css-13apmpg{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;margin:0;text-alight:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}</style><div class="css-13apmpg eneaom30"><style data-emotion="css 1gp7fjh">.css-1gp7fjh{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;margin-right:1rem;}@media (min-width: 38.73684210526316em){.css-1gp7fjh{display:none;}}</style><div class="css-1gp7fjh eneaom31"><style data-emotion="css i05np8">.css-i05np8{padding:0;background:none;border:none;color:var(--theme-ui-colors-text);cursor:pointer;font-size:0.8rem;}.css-i05np8:hover{color:var(--theme-ui-colors-primary);}</style><button type="button" aria-label="Open Navigation" title="Open Navigation" class="css-i05np8 e1onh9ai0"><style data-emotion="css z2vy6x">.css-z2vy6x{display:inline-block;width:30px;height:30px;}</style><span size="30" class="css-z2vy6x e1jw6cnh0"><style data-emotion="css 17rqqes">.css-17rqqes{fill:var(--theme-ui-colors-text);-webkit-transition:all 0.2s ease-out;transition:all 0.2s ease-out;}.css-17rqqes:hover,.css-17rqqes:focus{fill:var(--theme-ui-colors-primary);}</style><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" class="css-17rqqes e15jrc190"><path fill="none" d="M0 0h24v24H0V0z"></path><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"></path></svg></span></button></div><style data-emotion="css 13bl6n6">.css-13bl6n6{width:10rem;}.css-13bl6n6 p{margin:0;font-size:1.6rem;}</style><div class="css-13bl6n6 ewwdldv1"><style data-emotion="css o97vb3">.css-o97vb3{display:block;-webkit-text-decoration:none;text-decoration:none;color:var(--theme-ui-colors-text);-webkit-transition:color 0.2s ease-out;transition:color 0.2s ease-out;}.css-o97vb3:hover,.css-o97vb3:focus{color:var(--theme-ui-colors-primary);}</style><a class="css-o97vb3 ewwdldv0" href="/tietokannat/"><div data-gatsby-image-wrapper="" class="gatsby-image-wrapper gatsby-image-wrapper-constrained"><div style="max-width:2641px;display:block"><img alt="" role="presentation" aria-hidden="true" src="data:image/svg+xml;charset=utf-8,%3Csvg height=&#x27;1219&#x27; width=&#x27;2641&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27; version=&#x27;1.1&#x27;%3E%3C/svg%3E" style="max-width:100%;display:block;position:static"/></div><div aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear;background-color:#f8f8f8;position:absolute;top:0;left:0;bottom:0;right:0"></div><picture><source type="image/avif" data-srcset="/tietokannat/static/7c5268770640a4d118046a43d1aa9fe2/9469b/Centria-tunnus-RGB-FI-marginaalilla.avif 660w,/tietokannat/static/7c5268770640a4d118046a43d1aa9fe2/bb0ac/Centria-tunnus-RGB-FI-marginaalilla.avif 1321w,/tietokannat/static/7c5268770640a4d118046a43d1aa9fe2/7558a/Centria-tunnus-RGB-FI-marginaalilla.avif 2641w" sizes="(min-width: 2641px) 2641px, 100vw"/><source type="image/webp" data-srcset="/tietokannat/static/7c5268770640a4d118046a43d1aa9fe2/9ecf4/Centria-tunnus-RGB-FI-marginaalilla.webp 660w,/tietokannat/static/7c5268770640a4d118046a43d1aa9fe2/316a0/Centria-tunnus-RGB-FI-marginaalilla.webp 1321w,/tietokannat/static/7c5268770640a4d118046a43d1aa9fe2/93023/Centria-tunnus-RGB-FI-marginaalilla.webp 2641w" sizes="(min-width: 2641px) 2641px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 2641px) 2641px, 100vw" decoding="async" loading="lazy" data-src="/tietokannat/static/7c5268770640a4d118046a43d1aa9fe2/0cf45/Centria-tunnus-RGB-FI-marginaalilla.jpg" data-srcset="/tietokannat/static/7c5268770640a4d118046a43d1aa9fe2/39f99/Centria-tunnus-RGB-FI-marginaalilla.jpg 660w,/tietokannat/static/7c5268770640a4d118046a43d1aa9fe2/844fa/Centria-tunnus-RGB-FI-marginaalilla.jpg 1321w,/tietokannat/static/7c5268770640a4d118046a43d1aa9fe2/0cf45/Centria-tunnus-RGB-FI-marginaalilla.jpg 2641w" alt="Centria banner"/></picture><noscript><picture><source type="image/avif" srcSet="/tietokannat/static/7c5268770640a4d118046a43d1aa9fe2/9469b/Centria-tunnus-RGB-FI-marginaalilla.avif 660w,/tietokannat/static/7c5268770640a4d118046a43d1aa9fe2/bb0ac/Centria-tunnus-RGB-FI-marginaalilla.avif 1321w,/tietokannat/static/7c5268770640a4d118046a43d1aa9fe2/7558a/Centria-tunnus-RGB-FI-marginaalilla.avif 2641w" sizes="(min-width: 2641px) 2641px, 100vw"/><source type="image/webp" srcSet="/tietokannat/static/7c5268770640a4d118046a43d1aa9fe2/9ecf4/Centria-tunnus-RGB-FI-marginaalilla.webp 660w,/tietokannat/static/7c5268770640a4d118046a43d1aa9fe2/316a0/Centria-tunnus-RGB-FI-marginaalilla.webp 1321w,/tietokannat/static/7c5268770640a4d118046a43d1aa9fe2/93023/Centria-tunnus-RGB-FI-marginaalilla.webp 2641w" sizes="(min-width: 2641px) 2641px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 2641px) 2641px, 100vw" decoding="async" loading="lazy" src="/tietokannat/static/7c5268770640a4d118046a43d1aa9fe2/0cf45/Centria-tunnus-RGB-FI-marginaalilla.jpg" srcSet="/tietokannat/static/7c5268770640a4d118046a43d1aa9fe2/39f99/Centria-tunnus-RGB-FI-marginaalilla.jpg 660w,/tietokannat/static/7c5268770640a4d118046a43d1aa9fe2/844fa/Centria-tunnus-RGB-FI-marginaalilla.jpg 1321w,/tietokannat/static/7c5268770640a4d118046a43d1aa9fe2/0cf45/Centria-tunnus-RGB-FI-marginaalilla.jpg 2641w" alt="Centria banner"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1)}}</script></div></a></div></div></header><style data-emotion="css pn4xbf">.css-pn4xbf{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;min-height:100vh;position:relative;overflow-x:hidden;background:var(--theme-ui-colors-background);-webkit-transition:background 0.25s var(--ease-in-out-quad);transition:background 0.25s var(--ease-in-out-quad);}</style><div class="css-pn4xbf e1krdi8y3"><style data-emotion="css 1oex1pb">.css-1oex1pb{margin-left:-19rem;-webkit-flex:0 0 19rem;-ms-flex:0 0 19rem;flex:0 0 19rem;font-size:0.875rem;}@media (min-width: 38.73684210526316em){.css-1oex1pb{margin-left:0;}}</style><aside class="css-1oex1pb ednv8641"><style data-emotion="css 1wrooys">.css-1wrooys{position:fixed;top:0;bottom:0;overflow-x:hidden;overflow-y:auto;width:19rem;height:100%;padding:1rem 0;background:var(--theme-ui-colors-sidebar);-webkit-transition:0.25s var(--ease-in-out-quad);transition:0.25s var(--ease-in-out-quad);}@media (min-width: 38.73684210526316em){.css-1wrooys{-webkit-transform:translateX(0);-moz-transform:translateX(0);-ms-transform:translateX(0);transform:translateX(0);padding:6.6rem 0 1rem;}}</style><nav class="css-1wrooys ednv8640"><style data-emotion="css pv1s1f">.css-pv1s1f{margin:0;padding:0;list-style:none;}</style><ul class="css-pv1s1f e1dzqqml0"><style data-emotion="css 1lbpo2j">.css-1lbpo2j{position:relative;display:block;padding:0;margin:0.2rem 0;width:100%;list-style:none;}</style><li class="css-1lbpo2j eo1v1f02"><style data-emotion="css 2kw81a">.css-2kw81a{margin:0.5rem 0 0.5rem 1.2rem;padding:0;list-style:none;}.css-2kw81a>li{margin:0;}</style><ul class="css-2kw81a eo1v1f00"><li class="css-1lbpo2j eo1v1f02"><style data-emotion="css zl329z">.css-zl329z{display:block;padding:0.5rem 1.8rem 0.5rem 1.2rem;width:100%;color:var(--theme-ui-colors-text);font-weight:600;-webkit-text-decoration:none;text-decoration:none;-webkit-transition:color 0.2s ease-out;transition:color 0.2s ease-out;}.css-zl329z:hover,.css-zl329z:focus,.css-zl329z.is-active{color:var(--theme-ui-colors-primary);}</style><a class="css-zl329z eo1v1f01" href="/tietokannat/johdanto">Johdanto</a></li><li class="css-1lbpo2j eo1v1f02"><a class="css-zl329z eo1v1f01" href="/tietokannat/alkeet">SQL:n alkeet</a></li><li class="css-1lbpo2j eo1v1f02"><a class="css-zl329z eo1v1f01" href="/tietokannat/monta-taulua">Monta taulua</a></li><li class="css-1lbpo2j eo1v1f02"><a class="css-zl329z eo1v1f01" href="/tietokannat/lisaa-tekniikoita">Lisää tekniikoita</a></li><li class="css-1lbpo2j eo1v1f02"><a class="css-zl329z eo1v1f01" href="/tietokannat/suunnittelu">Tietokantojen suunnittelua</a></li><li class="css-1lbpo2j eo1v1f02"><a class="css-zl329z eo1v1f01" href="/tietokannat/tiedon-eheys">Tiedon eheys</a></li><li class="css-1lbpo2j eo1v1f02"><a aria-current="page" class="css-zl329z eo1v1f01 is-active" href="/tietokannat/tehokkuus">Tehokkuus</a></li><li class="css-1lbpo2j eo1v1f02"><a class="css-zl329z eo1v1f01" href="/tietokannat/tehtavat">Tehtävät ja koe</a></li></ul></li></ul></nav></aside><style data-emotion="css 1a5xr11">.css-1a5xr11{-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;min-width:20rem;padding-bottom:5rem;}</style><div class="css-1a5xr11 e1krdi8y2"><style data-emotion="css 1ni6xgg">.css-1ni6xgg{margin:auto;padding:2rem 1rem 2.5rem;-webkit-transition:0.25s var(--ease-in-out-quad);transition:0.25s var(--ease-in-out-quad);opacity:1;}@media (min-width: 38.73684210526316em){.css-1ni6xgg{-webkit-transform:translateX(0);-moz-transform:translateX(0);-ms-transform:translateX(0);transform:translateX(0);opacity:1;padding:7rem 3rem 3rem;max-width:50rem;}}</style><main class="css-1ni6xgg e1krdi8y1"><style data-emotion="css 1daj6ng">.css-1daj6ng{padding-top:0;margin-top:0;}.css-1daj6ng::before{display:none!important;}</style><h1 class="css-1daj6ng e137ubq00">Tehokkuus</h1><style data-emotion="css 1up8dbe">.css-1up8dbe{font-family:-apple-system,BlinkMacSystemFont,San Francisco,Helvetica Neue,Helvetica,Ubuntu,Roboto,Noto,Segoe UI,Arial,sans-serif;line-height:1.125;font-weight:700;margin-top:0;margin-bottom:16px;font-size:36px;}.css-1up8dbe::before{content:" ";display:block;padding-top:30px;margin-bottom:40px;border-bottom:1px solid;border-bottom-color:var(--theme-ui-colors-borderColor);}</style><h1 id="kyselyjen-suoritus" class="css-1up8dbe">Kyselyjen suoritus</h1><style data-emotion="css zitybv">.css-zitybv{margin-top:32px;margin-bottom:32px;}</style><p class="css-zitybv">SQL-kieli on tietokannan käyttäjälle mukava kyselyjen tekemisessä, koska käyttäjän riittää kuvata, mitä tietoa hän haluaa hakea, ja tietokantajärjestelmä hoitaa loput. Niinpä tietokantajärjestelmän on tärkeää pystyä löytämään jokin tehokas tapa toteuttaa käyttäjän antama kysely ja toimittaa kyselyn tulokset käyttäjälle.</p><style data-emotion="css vq3asz">.css-vq3asz{font-family:-apple-system,BlinkMacSystemFont,San Francisco,Helvetica Neue,Helvetica,Ubuntu,Roboto,Noto,Segoe UI,Arial,sans-serif;line-height:1.125;font-weight:700;margin-top:0;margin-bottom:16px;font-size:28px;}.css-vq3asz::before{content:" ";display:block;padding-top:30px;margin-bottom:40px;border-bottom:1px solid;border-bottom-color:var(--theme-ui-colors-borderColor);}</style><h2 id="kyselyn-suunnitelma-explain" class="css-vq3asz">Kyselyn suunnitelma (Explain)</h2><p class="css-zitybv">Monet tietokantajärjestelmät kertovat pyydettäessä suunnitelmansa, miten annettu kysely aiotaan suorittaa. Tämän avulla voimme tutkia tietokantajärjestelmän sisäistä toimintaa.</p><p class="css-zitybv">Tarkastellaan esimerkkinä kyselyä, joka hakee retiisin tiedot taulusta <style data-emotion="css 1eipsn1">.css-1eipsn1{color:var(--theme-ui-colors-primary);background:rgba(233, 218, 172, 0.15);border-radius:3px;padding-left:0.4rem;padding-right:0.4rem;padding-top:0.2rem;padding-bottom:0.2rem;}</style><code class="css-1eipsn1">Products</code>:</p><style data-emotion="css 14vuu3">.css-14vuu3{background-color:#282c34;color:#ffffff;font-family:"Operator Mono",monospace;font-size:0.9rem;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;overflow:auto;border-radius:6px;padding:16px;margin-top:32px;margin-bottom:32px;}.css-14vuu3 .attr-name{color:#c5a5c5;}.css-14vuu3 .attr-value{color:#8dc891;}.css-14vuu3 .comment,.css-14vuu3 .block-comment,.css-14vuu3 .prolog,.css-14vuu3 .doctype,.css-14vuu3 .cdata,.css-14vuu3 .shebang{color:#999999;}.css-14vuu3 .property,.css-14vuu3 .number,.css-14vuu3 .function-name,.css-14vuu3 .constant,.css-14vuu3 .symbol,.css-14vuu3 .deleted{color:#5a9bcf;}.css-14vuu3 .boolean{color:#ff8b50;}.css-14vuu3 .tag{color:#fc929e;}.css-14vuu3 .string{color:#8dc891;}.css-14vuu3 .punctuation{color:#8dc891;}.css-14vuu3 .selector,.css-14vuu3 .char,.css-14vuu3 .builtin,.css-14vuu3 .inserted{color:#D8DEE9;}.css-14vuu3 .function{color:#79b6f2;}.css-14vuu3 .operator,.css-14vuu3 .entity,.css-14vuu3 .url,.css-14vuu3 .variable{color:#d7deea;}.css-14vuu3 .keyword{color:#c5a5c5;}.css-14vuu3 .at-rule,.css-14vuu3 .class-name{color:#FAC863;}.css-14vuu3 .important{font-weight:400;}.css-14vuu3 .bold{font-weight:700;}.css-14vuu3 .italic{font-style:italic;}.css-14vuu3 .namespace{opacity:0.7;}.css-14vuu3 .highlight{background-color:var(--theme-ui-colors-highlight);font-weight:700;}</style><style data-emotion="css 1itelf7">.css-1itelf7{background-color:#282c34;color:#ffffff;font-family:"Operator Mono",monospace;font-size:0.9rem;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;overflow:auto;border-radius:6px;padding:16px;margin-top:32px;margin-bottom:32px;}.css-1itelf7 .attr-name{color:#c5a5c5;}.css-1itelf7 .attr-value{color:#8dc891;}.css-1itelf7 .comment,.css-1itelf7 .block-comment,.css-1itelf7 .prolog,.css-1itelf7 .doctype,.css-1itelf7 .cdata,.css-1itelf7 .shebang{color:#999999;}.css-1itelf7 .property,.css-1itelf7 .number,.css-1itelf7 .function-name,.css-1itelf7 .constant,.css-1itelf7 .symbol,.css-1itelf7 .deleted{color:#5a9bcf;}.css-1itelf7 .boolean{color:#ff8b50;}.css-1itelf7 .tag{color:#fc929e;}.css-1itelf7 .string{color:#8dc891;}.css-1itelf7 .punctuation{color:#8dc891;}.css-1itelf7 .selector,.css-1itelf7 .char,.css-1itelf7 .builtin,.css-1itelf7 .inserted{color:#D8DEE9;}.css-1itelf7 .function{color:#79b6f2;}.css-1itelf7 .operator,.css-1itelf7 .entity,.css-1itelf7 .url,.css-1itelf7 .variable{color:#d7deea;}.css-1itelf7 .keyword{color:#c5a5c5;}.css-1itelf7 .at-rule,.css-1itelf7 .class-name{color:#FAC863;}.css-1itelf7 .important{font-weight:400;}.css-1itelf7 .bold{font-weight:700;}.css-1itelf7 .italic{font-style:italic;}.css-1itelf7 .namespace{opacity:0.7;}.css-1itelf7 .highlight{background-color:var(--theme-ui-colors-highlight);font-weight:700;}</style><pre class="prism-code language-css-0 css-1itelf7"><div class="token-line"><span class="token plain">SELECT * FROM Products WHERE name=&#x27;radish&#x27;;</span></div></pre><p class="css-zitybv">Kun laitamme SQLitessä kyselyn eteen sanan <code class="css-1eipsn1">EXPLAIN</code>, saamme seuraavan tapaisen selostuksen suunnitelmasta:</p><pre class="prism-code language-css-0 css-1itelf7"><div class="token-line"><span class="token plain">sqlite&gt; EXPLAIN SELECT * FROM Products WHERE name=&#x27;radish&#x27;;</span></div><div class="token-line"><span class="token plain">addr  opcode         p1    p2    p3    p4             p5  comment      </span></div><div class="token-line"><span class="token plain">----  -------------  ----  ----  ----  -------------  --  -------------</span></div><div class="token-line"><span class="token plain">0     Init           0     12    0                    00  Start at 12  </span></div><div class="token-line"><span class="token plain">1     OpenRead       0     2     0     3              00  root=2 iDb=0; Products</span></div><div class="token-line"><span class="token plain">2     Rewind         0     10    0                    00               </span></div><div class="token-line"><span class="token plain">3       Column         0     1     1                    00  r[1]=Products.name</span></div><div class="token-line"><span class="token plain">4       Ne             2     9     1     (BINARY)       52  if r[2]!=r[1] goto 9</span></div><div class="token-line"><span class="token plain">5       Rowid          0     3     0                    00  r[3]=rowid   </span></div><div class="token-line"><span class="token plain">6       Copy           1     4     0                    00  r[4]=r[1]    </span></div><div class="token-line"><span class="token plain">7       Column         0     2     5                    00  r[5]=Products.price</span></div><div class="token-line"><span class="token plain">8       ResultRow      3     3     0                    00  output=r[3..5]</span></div><div class="token-line"><span class="token plain">9     Next           0     3     0                    01               </span></div><div class="token-line"><span class="token plain">10    Close          0     0     0                    00               </span></div><div class="token-line"><span class="token plain">11    Halt           0     0     0                    00               </span></div><div class="token-line"><span class="token plain">12    Transaction    0     0     1     0              01  usesStmtJournal=0</span></div><div class="token-line"><span class="token plain">13    TableLock      0     2     0     Products       00  iDb=0 root=2 write=0</span></div><div class="token-line"><span class="token plain">14    String8        0     2     0     radish        00  r[2]=&#x27;radish&#x27;</span></div><div class="token-line"><span class="token plain">15    Goto           0     1     0                    00</span></div></pre><p class="css-zitybv">SQLite muuttaa kyselyn tietokannan sisäiseksi <em class="css-0">ohjelmaksi</em>, joka hakee tietoa tauluista. Tässä tapauksessa ohjelman suoritus alkaa riviltä 12, jossa alkaa transaktio, ja sitten rivillä 14 rekisteriin 2 sijoitetaan hakuehdossa oleva merkkijono &quot;radish&quot;. Tämän jälkeen suoritus siirtyy riville 1, jossa aloitetaan taulun <code class="css-1eipsn1">Products</code> käsittely, ja rivit 2–9 muodostavat silmukan, joka etsii hakuehtoa vastaavat rivit taulusta.</p><p class="css-zitybv">Voimme myös pyytää tiiviimmän suunnitelman laittamalla kyselyn eteen sanat <code class="css-1eipsn1">EXPLAIN QUERY PLAN</code>. Tällöin tulos voi olla seuraava:</p><pre class="prism-code language-css-0 css-1itelf7"><div class="token-line"><span class="token plain">sqlite&gt; EXPLAIN QUERY PLAN SELECT * FROM Products WHERE name=&#x27;radish&#x27;;</span></div><div class="token-line"><span class="token plain">0|0|0|SCAN TABLE Products</span></div></pre><p class="css-zitybv">Tässä <code class="css-1eipsn1">SCAN TABLE Products</code> tarkoittaa, että kysely käy läpi taulun <code class="css-1eipsn1">Products</code> rivit.</p><h2 id="kyselyn-optimointi-optimizing-a-query" class="css-vq3asz">Kyselyn optimointi (Optimizing a query)</h2><p class="css-zitybv">Jos kyselyssä haetaan tietoa vain yhdestä taulusta, kysely on yleensä helppo suorittaa, mutta todelliset haasteet tulevat vastaan usean taulun kyselyissä. Tällöin tietokantajärjestelmän tulee osata <em class="css-0">optimoida (optimize)</em> kyselyn suorittamista eli muodostaa hyvä suunnitelma, jonka avulla halutut tiedot saadaan kerättyä tehokkaasti tauluista.</p><p class="css-zitybv">Tarkastellaan esimerkkinä seuraavaa kyselyä, joka listaa kurssien ja opettajien nimet:</p><pre class="language-sql prism-code language-sql css-1itelf7"><div class="token-line"><span class="token keyword">SELECT</span><span class="token plain"> C</span><span class="token punctuation">.</span><span class="token plain">name</span><span class="token punctuation">,</span><span class="token plain"> T</span><span class="token punctuation">.</span><span class="token plain">name </span><span class="token keyword">FROM</span><span class="token plain"> Courses C</span><span class="token punctuation">,</span><span class="token plain"> Teachers T </span><span class="token keyword">WHERE</span><span class="token plain"> C</span><span class="token punctuation">.</span><span class="token plain">teacher_id </span><span class="token operator">=</span><span class="token plain"> T</span><span class="token punctuation">.</span><span class="token plain">id</span><span class="token punctuation">;</span></div></pre><p class="css-zitybv">Koska kysely kohdistuu kahteen tauluun, olemme ajatelleet kyselyn toiminnan niin, että se muodostaa ensin kaikki rivien yhdistelmät tauluista <code class="css-1eipsn1">Courses</code> ja <code class="css-1eipsn1">Teachers</code> ja valitsee sitten ne rivit, joilla pätee ehto <code class="css-1eipsn1">C.teacher_id = T.id</code>. Tämä on hyvä ajattelutapa, mutta tämä ei vastaa sitä, miten kunnollinen tietokantajärjestelmä toimii.</p><p class="css-zitybv">Ongelmana on, että tauluissa <code class="css-1eipsn1">Courses</code> ja <code class="css-1eipsn1">Teachers</code> voi molemmissa olla suuri määrä rivejä. Esimerkiksi jos kummassakin taulussa on miljoona riviä, rivien yhdistelmiä olisi miljoona miljoonaa ja veisi valtavasti aikaa muodostaa ja käydä läpi kaikki yhdistelmät.</p><p class="css-zitybv">Tässä tilanteessa tietokantajärjestelmän pitääkin ymmärtää, mitä käyttäjä oikeastaan on hakemassa ja miten kyselyssä annettu ehto rajoittaa tulosrivejä. Käytännössä riittää käydä läpi kaikki taulun <code class="css-1eipsn1">Courses</code> rivit ja etsiä jokaisen rivin kohdalla jotenkin tehokkaasti yksittäinen haluttu rivi taulusta <code class="css-1eipsn1">Teachers</code>.</p><p class="css-zitybv">Voimme taas pyytää SQLiteä selittämään kyselyn suunnitelman:</p><pre class="prism-code language-css-0 css-1itelf7"><div class="token-line"><span class="token plain">sqlite&gt; EXPLAIN QUERY PLAN SELECT C.name, T.name FROM Courses C, Teachers T WHERE C.teacher_id = T.id;</span></div><div class="token-line"><span class="token plain">0|0|0|SCAN TABLE Courses AS C</span></div><div class="token-line"><span class="token plain">0|1|1|SEARCH TABLE Teachers AS T USING INTEGER PRIMARY KEY (rowid=?)</span></div></pre><p class="css-zitybv">Tämä kysely käy läpi taulun <code class="css-1eipsn1">Courses</code> rivit (<code class="css-1eipsn1">SCAN TABLE Courses</code>) ja hakee tietoa taulusta <code class="css-1eipsn1">Teachers</code> pääavaimen avulla (<code class="css-1eipsn1">SEARCH TABLE Teachers</code>). Jälkimmäinen tarkoittaa, että kun käsittelyssä on tietty taulun <code class="css-1eipsn1">Courses</code> rivi, kysely hakee tehokkaasti taulusta <code class="css-1eipsn1">Teachers</code> rivin, jossa pääavain <code class="css-1eipsn1">T.id</code> on sama kuin <code class="css-1eipsn1">C.teacher_id</code>.</p><p class="css-zitybv">Mutta miten käytännössä taulusta <code class="css-1eipsn1">Teachers</code> voi hakea tehokkaasti? Tämä onnistuu käyttämällä indeksiä, joihin tutustumme heti seuraavaksi.</p><h1 id="indeksit" class="css-1up8dbe">Indeksit</h1><p class="css-zitybv"><em class="css-0">Indeksi</em> on tietokannan taulun yhteyteen tallennettu hakemistorakenne, jonka tavoitteena on tehostaa tauluun liittyvien kyselyiden suorittamista. Indeksin avulla tietokantajärjestelmä voi selvittää tehokkaasti, missä päin taulua on rivejä, jotka täsmäävät tiettyyn hakuehtoon.</p><h2 id="pääavaimen-indeksi-primary-key-index" class="css-vq3asz">Pääavaimen indeksi (Primary key index)</h2><p class="css-zitybv">Kun tietokantaan luodaan taulu, sen pääavain saa automaattisesti indeksin. Tämän seurauksena voimme suorittaa tehokkaasti hakuja, joissa ehto liittyy pääavaimeen.</p><p class="css-zitybv">Esimerkiksi kun luomme SQLitessä taulun</p><pre class="language-sql prism-code language-sql css-1itelf7"><div class="token-line"><span class="token keyword">CREATE</span><span class="token plain"> </span><span class="token keyword">TABLE</span><span class="token plain"> Products </span><span class="token punctuation">(</span><span class="token plain">id </span><span class="token keyword">INTEGER</span><span class="token plain"> </span><span class="token keyword">PRIMARY</span><span class="token plain"> </span><span class="token keyword">KEY</span><span class="token punctuation">,</span><span class="token plain"> name </span><span class="token keyword">TEXT</span><span class="token punctuation">,</span><span class="token plain"> price </span><span class="token keyword">INTEGER</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div></pre><p class="css-zitybv">niin taululle luodaan indeksi sarakkeelle <code class="css-1eipsn1">id</code> ja voimme etsiä tehokkaasti tuotteita id-numeron perusteella. Tämän ansiosta esimerkiksi seuraava kysely toimii tehokkaasti:</p><pre class="language-sql prism-code language-sql css-1itelf7"><div class="token-line"><span class="token keyword">SELECT</span><span class="token plain"> price </span><span class="token keyword">FROM</span><span class="token plain"> Products </span><span class="token keyword">WHERE</span><span class="token plain"> id</span><span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">;</span></div></pre><p class="css-zitybv">Voimme varmistaa tämän kysymällä kyselyn suunnitelman:</p><pre class="prism-code language-css-0 css-1itelf7"><div class="token-line"><span class="token plain">sqlite&gt; EXPLAIN QUERY PLAN SELECT price FROM Products WHERE id=3;</span></div><div class="token-line"><span class="token plain">selectid    order       from        detail                                                   </span></div><div class="token-line"><span class="token plain">----------  ----------  ----------  ---------------------------------------------------------</span></div><div class="token-line"><span class="token plain">0           0           0           SEARCH TABLE Products USING INTEGER PRIMARY KEY (rowid=?)</span></div></pre><p class="css-zitybv">Suunnitelmassa näkyy <code class="css-1eipsn1">SEARCH TABLE</code>, mikä tarkoittaa, että kysely pystyy hakemaan taulusta tietoa tehokkaasti indeksin avulla.</p><h2 id="indeksin-luominen" class="css-vq3asz">Indeksin luominen</h2><p class="css-zitybv">Pääavaimen indeksi on kätevä, mutta voimme haluta myös etsiä tietoa jonkin muun sarakkeen perusteella. Esimerkiksi seuraava kysely hakee rivit sarakkeen <code class="css-1eipsn1">price</code> perusteella:</p><pre class="language-sql prism-code language-sql css-1itelf7"><div class="token-line"><span class="token keyword">SELECT</span><span class="token plain"> name </span><span class="token keyword">FROM</span><span class="token plain"> Products </span><span class="token keyword">WHERE</span><span class="token plain"> price</span><span class="token operator">=</span><span class="token number">4</span><span class="token punctuation">;</span></div></pre><p class="css-zitybv">Tämä kysely ei ole oletuksena tehokas, koska sarakkeelle <code class="css-1eipsn1">price</code> ei ole indeksiä. Näemme tämän pyytämällä taas selitystä kyselystä:</p><pre class="prism-code language-css-0 css-1itelf7"><div class="token-line"><span class="token plain">sqlite&gt; EXPLAIN QUERY PLAN SELECT name FROM Products WHERE price=4;</span></div><div class="token-line"><span class="token plain">selectid    order       from        detail             </span></div><div class="token-line"><span class="token plain">----------  ----------  ----------  -------------------</span></div><div class="token-line"><span class="token plain">0           0           0           SCAN TABLE Products</span></div></pre><p class="css-zitybv">Nyt suunnitelmassa näkyy <code class="css-1eipsn1">SCAN TABLE</code>, mikä tarkoittaa, että kysely joutuu käymään läpi taulun kaikki rivit. Tämä on hidasta, jos taulussa on paljon rivejä.</p><p class="css-zitybv">Voimme kuitenkin luoda uuden indeksin, joka tehostaa saraketta <code class="css-1eipsn1">price</code> käyttäviä kyselyitä. Saamme luotua indeksin komennolla <code class="css-1eipsn1">CREATE INDEX</code> näin:</p><pre class="language-sql prism-code language-sql css-1itelf7"><div class="token-line"><span class="token keyword">CREATE</span><span class="token plain"> </span><span class="token keyword">INDEX</span><span class="token plain"> idx_price </span><span class="token keyword">ON</span><span class="token plain"> Products </span><span class="token punctuation">(</span><span class="token plain">price</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div></pre><p class="css-zitybv">Tässä <code class="css-1eipsn1">idx_price</code> on indeksin nimi, jolla voimme viitata siihen myöhemmin. Indeksi toimii luonnin jälkeen täysin automaattisesti, eli tietokantajärjestelmä osaa käyttää sitä kyselyissä ja huolehtii sen päivittämisestä.</p><h2 id="miten-indeksi-toimii" class="css-vq3asz">Miten indeksi toimii?</h2><p class="css-zitybv">Indeksi tarvitsee tuekseen hakemistorakenteen, josta voi hakea tehokkaasti rivejä sarakkeen arvon perusteella. Tämä voidaan toteuttaa esimerkiksi puurakenteena, jonka avaimina on sarakkeiden arvoja.</p><p class="css-zitybv">Indeksin luomisen jälkeen voimme kysyä uudestaan kyselyn suunnitelmaa:</p><pre class="prism-code language-css-0 css-1itelf7"><div class="token-line"><span class="token plain">sqlite&gt; EXPLAIN QUERY PLAN SELECT name FROM Products WHERE price=4;</span></div><div class="token-line"><span class="token plain">selectid    order       from        detail                                               </span></div><div class="token-line"><span class="token plain">----------  ----------  ----------  -----------------------------------------------------</span></div><div class="token-line"><span class="token plain">0           0           0           SEARCH TABLE Products USING INDEX idx_price (price=?)</span></div></pre><p class="css-zitybv">Indeksin ansiosta suunnitelmassa ei lue enää <code class="css-1eipsn1">SCAN TABLE</code> vaan <code class="css-1eipsn1">SEARCH TABLE</code>. Suunnitelmassa näkyy myös, että aikomuksena on hyödyntää indeksiä <code class="css-1eipsn1">idx_price</code>.</p><h2 id="lisää-käyttötapoja" class="css-vq3asz">Lisää käyttötapoja</h2><p class="css-zitybv">Voimme käyttää indeksiä myös kyselyissä, joissa haemme pienempiä tai suurempia arvoja. Esimerkiksi sarakkeelle <code class="css-1eipsn1">price</code> luodun indeksin avulla voimme etsiä vaikkapa rivejä, joille pätee ehto <code class="css-1eipsn1">price&lt;3</code> tai <code class="css-1eipsn1">price&gt;=8</code>.</p><p class="css-zitybv">Indeksi on myös mahdollista luoda usean sarakkeen perusteella. Esimerkiksi voisimme luoda indeksin näin:</p><pre class="language-sql prism-code language-sql css-1itelf7"><div class="token-line"><span class="token keyword">CREATE</span><span class="token plain"> </span><span class="token keyword">INDEX</span><span class="token plain"> idx_price </span><span class="token keyword">ON</span><span class="token plain"> Products </span><span class="token punctuation">(</span><span class="token plain">price</span><span class="token punctuation">,</span><span class="token plain">name</span><span class="token punctuation">)</span><span class="token punctuation">;</span></div></pre><p class="css-zitybv">Tässä indeksissä rivit on järjestetty ensisijaisesti hinnan ja toissijaisesti nimen mukaan. Indeksi tehostaa hakuja, joissa hakuperusteena on joko pelkkä hinta tai yhdessä hinta ja nimi. Kuitenkaan indeksi ei tehosta hakuja, joissa hakuperusteena on pelkkä nimi.</p><h2 id="milloin-luoda-indeksi" class="css-vq3asz">Milloin luoda indeksi?</h2><p class="css-zitybv">Periaatteessa voisi ajatella, että taulun jokaiselle sarakkeelle kannattaa luoda indeksi, jolloin monenlaiset kyselyt ovat nopeita. Tämä ei ole kuitenkaan käytännössä hyvä idea.</p><p class="css-zitybv">Vaikka indeksit tehostavat kyselyitä, niissä on myös kaksi ongelmaa: indeksin hakemistorakenne vie tilaa ja indeksi myös hidastaa tiedon lisäämistä ja muuttamista. Jälkimmäinen johtuu siitä, että kun taulun sisältö muuttuu, niin muutos täytyy myös päivittää kaikkiin tauluun liittyviin indekseihin. Indeksiä ei siis kannata luoda huvin vuoksi.</p><p class="css-zitybv">Hyvä syy indeksin luontiin on, että haluamme suorittaa usein tietynlaisia kyselyitä ja ne toimivat hitaasti, koska tietokantajärjestelmä joutuu käymään läpi turhaan jonkin taulun kaikki rivit kyselyn aikana. Tällöin voimme lisätä taululle indeksin, jonka avulla tällaiset kyselyt toimivat jatkossa tehokkaasti.</p><p class="css-zitybv">Indekseillä on käytännössä suuri vaikutus tietokantojen tehokkuuteen. Moni tietokanta toimii hitaasti sen takia, että siitä puuttuu oleellisia indeksejä. Tasapaino riittävien ja liian monen indeksin välillä on herkkä, ja pitäisi ottaa huomioon tietokantojen kehityksessä.</p><h1 id="tiedon-toisteisuus" class="css-1up8dbe">Tiedon toisteisuus</h1><p class="css-zitybv">Ideaalitilanteessa tietokantaa suunnitellessa tietokanta ei sisällä toisteista tietoa, joka pystyttäisiin päättelemään toisaalta tietokannassa. Joskus meidän täytyy hieman taivuttaa tätä sääntöä tehdäksemme kyselyistämme tehokkaampia.</p><h2 id="esimerkki" class="css-vq3asz">Esimerkki</h2><p class="css-zitybv">Tarkastellaan pankin tietokantaa, jossa taulu <code class="css-1eipsn1">Transactions</code> sisältää tietoa tilisiirroista. Jokaiselle siirrolle on sarake <code class="css-1eipsn1">change</code> joka indikoi kuinka paljon tilin tase muuttuu (eli arvo voi olla positiivinen tai negatiivinen).</p><p class="css-zitybv">Seuraava esimerkki palauttaa tilin tämänhetkisen saldon tilille 123 laskemalla yhteen kaikki tiliin liittyvät muutokset:</p><pre class="language-sql prism-code language-sql css-1itelf7"><div class="token-line"><span class="token keyword">SELECT</span><span class="token plain"> </span><span class="token function">SUM</span><span class="token punctuation">(</span><span class="token plain">change</span><span class="token punctuation">)</span><span class="token plain"> </span><span class="token keyword">FROM</span><span class="token plain"> </span><span class="token keyword">Transactions</span><span class="token plain"> </span><span class="token keyword">WHERE</span><span class="token plain"> account_id</span><span class="token operator">=</span><span class="token number">123</span><span class="token punctuation">;</span></div></pre><p class="css-zitybv">Tämä on sinänsä hyvä kysely, mutta sen pitää käydä läpi kaikki tiliin 123 liittyvät rivit taulusta <code class="css-1eipsn1">Transactions</code> löytääkseen nykyisen saldon. Tämä on melkolailla ylimääräistä työtä, sillä meitä ei kiinnosta historia vaan ainoastaan saldo.</p><p class="css-zitybv">Voimme tehdä kyselystä tehokkaamman luomalla uuden taulun <code class="css-1eipsn1">Balances</code>, joka sisältää tilien saldot. Tämän taulun avulla voimme hakea saldon tilille 123 näin helposti:</p><pre class="language-sql prism-code language-sql css-1itelf7"><div class="token-line"><span class="token keyword">SELECT</span><span class="token plain"> balance </span><span class="token keyword">FROM</span><span class="token plain"> Balances </span><span class="token keyword">FROM</span><span class="token plain"> account_id</span><span class="token operator">=</span><span class="token number">123</span><span class="token punctuation">;</span></div></pre><p class="css-zitybv">Tässä rikomme periaatetta, että tietokannassa ei pitäisi olla tietoa joka voidaan laskea muualta tietokannasta, sillä taulu <code class="css-1eipsn1">Balances</code> pystytään laskemaan taulusta <code class="css-1eipsn1">Transactions</code>. Tällä tavoin tosin voimme tehdä todella paljon tehokkaamman kyselyn.</p><p class="css-zitybv">Mitä vikaa on periaatteen rikkomisessa? No, teimme juuri tietokannan päivittämisestä hankalampaa. Joka kerta kun nyt lisäämme uuden rivin tauluun `<code class="css-1eipsn1">Transactions</code>, joudumme myös päivittämään tietoa taulussa <code class="css-1eipsn1">Balances</code>. Aiemmin saldo laskettiin suoraan tilisiirroista, joka oli aina ajantasalla.</p><h2 id="denormalisointi-denormalization" class="css-vq3asz">Denormalisointi (Denormalization)</h2><p class="css-zitybv">Tietokantojen teoriassa käytetään termiä <em class="css-0">denormalisointi (denormalization)</em>, mikä tarkoittaa kyselyiden tehostamista lisäämällä toisteista tietoa. Tällä kertaa teemme siis melko päinvastaista kuin normalisoidessa.</p><h2 id="muutokset-vastaan-kyselyt" class="css-vq3asz">Muutokset vastaan kyselyt</h2><p class="css-zitybv">Usein esiintyvä ilmiö tietotekniikassa on, että joudumme tasapainoilemaan sen kanssa, haluammeko muuttaa vai hakea tehokkaasti tietoa ja paljonko tilaa voimme käyttää. Tämä tulee tietokantojen lisäksi vastaan esimerkiksi algoritmien suunnittelussa.</p><p class="css-zitybv">Jos tietokannassa ei ole toisteista tietoa, muutokset ovat helppoja, koska jokainen tieto on vain yhdessä paikassa eli riittää muuttaa vain yhden taulun yhtä riviä. Myös hyvänä puolena tietokanta vie vähän tilaa. Toisaalta kyselyt voivat olla monimutkaisia ja hitaita, koska halutut tiedot pitää kerätä kasaan eri puolilta tietokantaa.</p><p class="css-zitybv">Kun sitten lisäämme toisteista tietoa, pystymme nopeuttamaan kyselyjä mutta toisaalta muutokset hidastuvat, koska muutettu tieto pitää päivittää useaan paikkaan. Samaan aikaan myös tietokannan tilankäyttö kasvaa toisteisen tiedon takia.</p><p class="css-zitybv">Valitettavasti ei ole mitään yleistä sääntöä, paljonko toisteista tietoa kannattaa lisätä, vaan tämä riippuu tietokannan sisällöstä ja halutuista kyselyistä. Yksi hyvä tapa on aloittaa tilanteesta, jossa toisteista tietoa ei ole, ja lisätä sitten toisteista tietoa tarvittaessa, jos osoittautuu, että kyselyt eivät muuten ole riittävän tehokkaita.</p><p class="css-zitybv">Huomaa, että indeksointi on myös yksi esimerkki kuinka toisteinen tieto tekee kyselyistä tehokkaampia. Tällöin toisteinen tieto ei ole talletettu tauluihin, vaan taulujuen ulkopuolelle omiin tietorakenteisiinsa.</p></main></div><style data-emotion="css 7oi17p">.css-7oi17p{display:none;-webkit-flex:0 0 16rem;-ms-flex:0 0 16rem;flex:0 0 16rem;font-size:0.75rem;font-weight:600;}@media (min-width: 56.36842105263158em){.css-7oi17p{display:block;}}</style><aside class="css-7oi17p e18xy85f4"><style data-emotion="css dxzn2c">.css-dxzn2c{position:fixed;top:0;bottom:0;overflow-x:hidden;overflow-y:auto;width:16rem;height:100%;padding:7rem 1rem 0;}</style><nav class="css-dxzn2c e18xy85f3"><style data-emotion="css 1w6ve1a">.css-1w6ve1a{margin-top:0;font-size:0.7rem;font-weight:700;text-transform:uppercase;}</style><p class="css-1w6ve1a e18xy85f2">Contents</p><style data-emotion="css evawql">.css-evawql{margin:0;padding:0;list-style:none;}.css-evawql ul{margin:0;padding:0;list-style:none;}</style><ul class="css-evawql e18xy85f1"><style data-emotion="css 1uvgd5">.css-1uvgd5{margin:0.3rem 0;}</style><li class="css-1uvgd5 e18xy85f0"><style data-emotion="css 1j0udpt">.css-1j0udpt{display:inline-block;padding:0.2rem 0;width:100%;color:var(--theme-ui-colors-text);-webkit-text-decoration:none;text-decoration:none;-webkit-transition:color 0.2s ease-out;transition:color 0.2s ease-out;}.css-1j0udpt:hover,.css-1j0udpt:focus{color:var(--theme-ui-colors-primary);}</style><a href="/tietokannat/tehokkuus#kyselyjen-suoritus" class="css-1j0udpt e1r4v4s10">Kyselyjen suoritus</a></li><li class="css-1uvgd5 e18xy85f0"><a href="/tietokannat/tehokkuus#kyselyn-suunnitelma-explain" class="css-1j0udpt e1r4v4s10">Kyselyn suunnitelma (Explain)</a></li><li class="css-1uvgd5 e18xy85f0"><a href="/tietokannat/tehokkuus#kyselyn-optimointi-optimizing-a-query" class="css-1j0udpt e1r4v4s10">Kyselyn optimointi (Optimizing a query)</a></li><li class="css-1uvgd5 e18xy85f0"><a href="/tietokannat/tehokkuus#indeksit" class="css-1j0udpt e1r4v4s10">Indeksit</a></li><li class="css-1uvgd5 e18xy85f0"><a href="/tietokannat/tehokkuus#pääavaimen-indeksi-primary-key-index" class="css-1j0udpt e1r4v4s10">Pääavaimen indeksi (Primary key index)</a></li><li class="css-1uvgd5 e18xy85f0"><a href="/tietokannat/tehokkuus#indeksin-luominen" class="css-1j0udpt e1r4v4s10">Indeksin luominen</a></li><li class="css-1uvgd5 e18xy85f0"><a href="/tietokannat/tehokkuus#miten-indeksi-toimii" class="css-1j0udpt e1r4v4s10">Miten indeksi toimii?</a></li><li class="css-1uvgd5 e18xy85f0"><a href="/tietokannat/tehokkuus#lisää-käyttötapoja" class="css-1j0udpt e1r4v4s10">Lisää käyttötapoja</a></li><li class="css-1uvgd5 e18xy85f0"><a href="/tietokannat/tehokkuus#milloin-luoda-indeksi" class="css-1j0udpt e1r4v4s10">Milloin luoda indeksi?</a></li><li class="css-1uvgd5 e18xy85f0"><a href="/tietokannat/tehokkuus#tiedon-toisteisuus" class="css-1j0udpt e1r4v4s10">Tiedon toisteisuus</a></li><li class="css-1uvgd5 e18xy85f0"><a href="/tietokannat/tehokkuus#esimerkki" class="css-1j0udpt e1r4v4s10">Esimerkki</a></li><li class="css-1uvgd5 e18xy85f0"><a href="/tietokannat/tehokkuus#denormalisointi-denormalization" class="css-1j0udpt e1r4v4s10">Denormalisointi (Denormalization)</a></li><li class="css-1uvgd5 e18xy85f0"><a href="/tietokannat/tehokkuus#muutokset-vastaan-kyselyt" class="css-1j0udpt e1r4v4s10">Muutokset vastaan kyselyt</a></li></ul></nav></aside><style data-emotion="css jl45xv">.css-jl45xv{text-align:center;position:absolute;bottom:0;width:100%;height:6rem;padding-top:10px;font-size:1rem;background:var(--theme-ui-colors-footer);color:var(--theme-ui-colors-text);}.css-jl45xv a{-webkit-text-decoration:none;text-decoration:none;color:var(--theme-ui-colors-background);}</style><footer class="css-jl45xv e1krdi8y0"><p>© <!-- -->2024<!-- -->, Julkaisija<a href="https://net.centria.fi/"> Centria</a></p><p>Lisää tietoa <a href="/tietokannat/lisenssi">Lisenssistä</a></p></footer></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/tehokkuus";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-0d51d282d68ddbc99621.js"],"app":["/app-5c8ce36b7ca7ddadeb9f.js"],"component---src-pages-404-js":["/component---src-pages-404-js-546f88170e8a99e0b45e.js"],"component---src-templates-docs-js":["/component---src-templates-docs-js-7a892bb90a0bfa08d7aa.js"]};/*]]>*/</script><script src="/tietokannat/polyfill-0d51d282d68ddbc99621.js" nomodule=""></script><script src="/tietokannat/component---src-templates-docs-js-7a892bb90a0bfa08d7aa.js" async=""></script><script src="/tietokannat/commons-18bdf9bc0a4174f228aa.js" async=""></script><script src="/tietokannat/app-5c8ce36b7ca7ddadeb9f.js" async=""></script><script src="/tietokannat/framework-d79a9ccabaa25efea902.js" async=""></script><script src="/tietokannat/webpack-runtime-3a0255c245ffc5167309.js" async=""></script></body></html>